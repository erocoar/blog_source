---
title: Score Residual Plots for Ordinal Logistic Regression
author: ~
date: '2017-12-30'
draft: True
slug: score-residual-plots-for-ordinal-logistic-regression
categories: []
tags: []
---



<pre class="r"><code>library(rms)</code></pre>
<pre><code>## Warning: Paket &#39;rms&#39; wurde unter R Version 3.3.3 erstellt</code></pre>
<pre><code>## Lade nötiges Paket: Hmisc</code></pre>
<pre><code>## Warning: Paket &#39;Hmisc&#39; wurde unter R Version 3.3.3 erstellt</code></pre>
<pre><code>## Lade nötiges Paket: lattice</code></pre>
<pre><code>## Lade nötiges Paket: survival</code></pre>
<pre><code>## Warning: Paket &#39;survival&#39; wurde unter R Version 3.3.3 erstellt</code></pre>
<pre><code>## Lade nötiges Paket: Formula</code></pre>
<pre><code>## Lade nötiges Paket: ggplot2</code></pre>
<pre><code>## 
## Attache Paket: &#39;Hmisc&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:base&#39;:
## 
##     format.pval, round.POSIXt, trunc.POSIXt, units</code></pre>
<pre><code>## Lade nötiges Paket: SparseM</code></pre>
<pre><code>## Warning: Paket &#39;SparseM&#39; wurde unter R Version 3.3.3 erstellt</code></pre>
<pre><code>## 
## Attache Paket: &#39;SparseM&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:base&#39;:
## 
##     backsolve</code></pre>
<pre class="r"><code>f &lt;- lrm(factor(points) ~ price, data = wines, x = TRUE, y = TRUE)

resid(f , &#39;score.binary&#39;, pl = TRUE)</code></pre>
<p><img src="/posts/2017-12-30-score-residual-plots-for-ordinal-logistic-regression_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p>
<pre class="r"><code>library(MASS)</code></pre>
<pre><code>## Warning: Paket &#39;MASS&#39; wurde unter R Version 3.3.3 erstellt</code></pre>
<pre class="r"><code>m &lt;- polr(factor(points) ~ price, data = wines)

cbind(
  mean(wines$price * ((wines$points &gt;= 1) - plogis(wines$price * f$coefficients[4] + f$coefficients[1]))),
  mean(wines$price * ((wines$points &gt;= 2) - plogis(wines$price * f$coefficients[4] + f$coefficients[2]))),
  mean(wines$price * ((wines$points &gt;= 3) - plogis(wines$price * f$coefficients[4] + f$coefficients[3]))))</code></pre>
<pre><code>##           [,1]      [,2]      [,3]
## [1,] 0.0300016 0.4756652 -0.486989</code></pre>
<pre class="r"><code>m.zeta &lt;- m$zeta*-1
cbind(
  mean(wines$price * ((wines$points &gt;= 1) - plogis(wines$price * m$coefficients + m.zeta[1]))),
  mean(wines$price * ((wines$points &gt;= 2) - plogis(wines$price * m$coefficients + m.zeta[2]))), 
  mean(wines$price * ((wines$points &gt;= 3) - plogis(wines$price * m$coefficients + m.zeta[3]))))</code></pre>
<pre><code>##         [,1]      [,2]       [,3]
## [1,] 0.02977 0.4750657 -0.4864588</code></pre>
